{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack:///./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack:///./src/views/crud/auth.vue?a4d8","webpack:///src/views/crud/auth.vue","webpack:///./src/views/crud/auth.vue?00cc","webpack:///./src/views/crud/auth.vue","webpack:///./src/services/session.mixin.js","webpack:///./src/views/crud/base.vue?be33","webpack:///./src/views/crud/base.vue?e5db","webpack:///src/views/crud/base.vue","webpack:///./src/views/crud/base.vue?3430","webpack:///./src/views/crud/base.vue"],"names":["_objectWithoutPropertiesLoose","source","excluded","key","i","target","sourceKeys","Object","keys","length","indexOf","_objectWithoutProperties","objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","render","_vm","this","_h","$createElement","_c","_self","staticClass","_t","_v","schema","attrs","on","doAuth","scopedSlots","_u","fn","ref","hasErrors","$event","$emit","refresh","model","value","callback","$$v","expression","staticRenderFns","mixins","props","data","methods","loading","authenticate","form","error","e","success","console","log","message","response","beforeMount","login","component","computed","currentProject","$store","state","config","project","auth","hasAuth","has","showCrud","logged","get","code","session","username","secret","remember","request","url_login","method","headers","then","res","token","storageToken","reqAuthData","authRequest","commit","Error","sessionStorage","setItem","isLogged","Promise","reject","options","user","setUser","tokenRequest","params","interpolate","id","name","role","_s","active","title","_e","loadModel","cache","ignoreCache","errors","actions","formTitle","formopen","row","formHook","closeForm","slot","components","Auth","Table","Forms","models","formLogin","watch","$route","$router","push","crud","reloadData","$refs","tables","fetchData","api","assign"],"mappings":"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","file":"js/chunk-1952a3df.26d9d7d7.js","sourcesContent":["export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"crud-wrapper\"},[(_vm.login)?_vm._t(\"default\",[_vm._v(\" vazio \")],{\"schema\":_vm.schema}):_c('div',{staticClass:\"col-12 col-md-4 offset-md-4\"},[(_vm.loading)?_c('h3',{staticClass:\"text-center\"},[_vm._v(\"Authenticating...\"),_c('CSpinner',{attrs:{\"color\":\"info\",\"size\":\"sm\"}})],1):_c('FormulateForm',{on:{\"submit\":_vm.doAuth},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar hasErrors = ref.hasErrors;\nreturn [_c('h4',{staticClass:\"text-center\"},[_vm._v(\"Project Authentication\")]),_c('FormulateInput',{attrs:{\"type\":\"text\",\"name\":\"username\",\"placeholder\":\"Username\"}}),_c('FormulateInput',{attrs:{\"type\":\"password\",\"name\":\"secret\",\"placeholder\":\"Password\"}}),_c('FormulateInput',{attrs:{\"type\":\"checkbox\",\"name\":\"remember\",\"label\":\"remember\"}}),_c('div',{staticClass:\"action-buttons mt-3\"},[_c('CButton',{staticClass:\"mr-2\",attrs:{\"type\":\"button\",\"color\":\"danger\"},on:{\"click\":function($event){return _vm.$emit('close', { refresh: false })}}},[_vm._v(\" Cancel \")]),_c('CButton',{attrs:{\"type\":\"submit\",\"color\":\"success\",\"disabled\":hasErrors}},[_vm._v(\" Save \")])],1)]}}]),model:{value:(_vm.model),callback:function ($$v) {_vm.model=$$v},expression:\"model\"}})],1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template >\r\n  <section class=\"crud-wrapper\" >\r\n    <slot v-if=\"login\" v-bind:schema=\"schema\">\r\n      vazio\r\n    </slot>\r\n    <div  v-else class=\"col-12 col-md-4 offset-md-4\">\r\n        <h3 v-if=\"loading\" class=\"text-center\">Authenticating...<CSpinner color=\"info\" size=\"sm\"/></h3>\r\n        <FormulateForm \r\n          v-else\r\n          v-model=\"model\"\r\n          @submit=\"doAuth\"\r\n          #default=\"{ hasErrors }\"\r\n        >\r\n\r\n          <h4 class=\"text-center\">Project Authentication</h4>\r\n          \r\n          <FormulateInput type=\"text\" name=\"username\" placeholder=\"Username\" /> \r\n\r\n          <FormulateInput type=\"password\" name=\"secret\"  placeholder=\"Password\" /> \r\n\r\n          <FormulateInput type=\"checkbox\" name=\"remember\" label=\"remember\" /> \r\n\r\n          <div class=\"action-buttons mt-3\">\r\n            <CButton\r\n                type=\"button\"\r\n                color=\"danger\"\r\n                class=\"mr-2\"\r\n                @click=\"$emit('close', { refresh: false })\"\r\n              >\r\n                  Cancel\r\n            </CButton>\r\n            <CButton\r\n                type=\"submit\"\r\n                color=\"success\"\r\n                :disabled=\"hasErrors\"\r\n              >\r\n                  Save\r\n            </CButton>\r\n          </div>\r\n        </FormulateForm>\r\n    </div>\r\n\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport { has, get } from 'lodash'\r\nimport SessionMixin from '../../services/session.mixin'\r\n\r\nexport default {\r\n  mixins:[SessionMixin],\r\n  props:{\r\n      project:{\r\n        type: Object,\r\n        default: {}\r\n      },\r\n      schema:{\r\n        type: Object,\r\n        default: {}\r\n      }\r\n  },\r\n  data(){return{\r\n    loading: false,\r\n    model: {},\r\n    login: false\r\n  }},\r\n  methods:{\r\n    doAuth(form){\r\n      try{\r\n        this.loading = true;\r\n        return this.authenticate(form)\r\n                  .then(this.success)\r\n                  .catch(this.error)\r\n      }catch(e){\r\n        this.error(e)\r\n        this.loading = false;\r\n      }\r\n    },\r\n    success(res){\r\n        let token = this.storageToken(res)\r\n        let { data, headers } = res;\r\n\r\n        if( !token ) {\r\n          this.loading = false;\r\n          return this.$emit('auth:failed', {message: 'token not found', config, data, headers})\r\n        }\r\n        let authRequest = this.authRequest(token)\r\n       \r\n        this.$emit('auth:logged', { logged: this.logged, request: authRequest })\r\n        this.loading = false;\r\n        this.login = true;\r\n                    \r\n    },\r\n    error({ response, message, ...data }){\r\n      console.log('Auth Error', message, response, data)\r\n      this.loading = false;\r\n      \r\n      this.$emit('auth:failed', {message})\r\n    },\r\n    async checkLogged(token){\r\n      try{\r\n        let auth = await this.isLogged(token)\r\n\r\n        console.debug('checkLogged: isLogged', auth)\r\n        \r\n        this.$emit('auth:logged', auth)\r\n\r\n        return auth\r\n      }catch(e){\r\n        console.debug('checkLogged failed: token', e)\r\n        this.login = false;\r\n        return this.$emit('auth:failed', {message: e.message})\r\n      }\r\n    }, \r\n  },\r\n  beforeMount(){\r\n    this.login = false\r\n      console.log('caled before mount')\r\n  },\r\n  async mounted(){\r\n    try{\r\n      console.debug('caled mounted auth')\r\n      if( !this.hasAuth ) return this.login = true \r\n\r\n      console.debug('auth process start')\r\n      let token = sessionStorage.getItem(`${this.project.code}_session`)\r\n      console.debug('token session', token)\r\n\r\n      this.loading = true;\r\n      if( token && get(this.session, 'logged', false) ){\r\n        this.$emit('auth:logged', {token, user: get(this.session, 'user', {}), request: this.authRequest(token) })\r\n        \r\n        console.debug('token and user exists', this.authRequest(token), this.session)\r\n        this.schema.api = Object.assign(this.schema.api, this.authRequest(token))\r\n        this.loading = false;\r\n        this.login = true;\r\n      }else if( token ){\r\n        let { request={}, ...data } = await this.checkLogged(token)\r\n\r\n        console.debug('token exists relogin', request, data)\r\n        this.schema.api = Object.assign(this.schema.api, request)\r\n        \r\n        this.loading = false;\r\n        this.login = true;\r\n      }else{\r\n        this.loading = false;\r\n        this.login = false;\r\n        console.debug('show login form')\r\n      } \r\n    }catch(e){\r\n      this.login = false;\r\n      this.loading = false;\r\n      console.log('erro mounted auth', e)\r\n      this.$emit('auth:failed', e)\r\n    } \r\n  }\r\n}\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./auth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./auth.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./auth.vue?vue&type=template&id=4efc6955&\"\nimport script from \"./auth.vue?vue&type=script&lang=js&\"\nexport * from \"./auth.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { has, get } from 'lodash'\r\nimport { interpolate } from './helpers'\r\nimport { request } from './models'\r\n\r\nexport default {\r\n  computed: {\r\n    currentProject(){\r\n      return this.$store.state.currentProject || null\r\n    }, \r\n    config(){ \r\n      return this.project.auth || null \r\n    },\r\n    hasAuth() {\r\n      return has(this.currentProject, 'auth');\r\n    },\r\n    showCrud() {\r\n      return (!this.hasAuth || (this.hasAuth && this.logged))\r\n    },\r\n    logged(){ \r\n      return get(this.$store, `state.auth.${this.currentProject.code}.logged`, false)\r\n    },\r\n    session(){ \r\n      return get(this.$store, `state.auth.${this.currentProject.code}`, false)\r\n    }\r\n  },\r\n  methods: {\r\n    authenticate({username, secret, remember}){\r\n      try{\r\n        if( !has(this.config, 'url_login') ) return new Error('url login doest exist');\r\n\r\n        return request(this.config.url_login, {\r\n                        method: get(this.config, 'url_method', 'post'),\r\n                        data: {\r\n                          [get(this.config, 'field_username', 'email')]: username,\r\n                          [get(this.config, 'field_secret', 'password')]: secret,\r\n                          [get(this.config, 'field_remember', 'remember')]: remember,\r\n                        },\r\n                        headers:{\r\n                          [get(this.config, 'request_token', 'access-token')]: ''\r\n                        }\r\n                      }, false )\r\n                .then((res) => {\r\n                  let token = this.storageToken(res)\r\n                  let reqAuthData = this.authRequest(token)\r\n\r\n                  this.$store.commit('setAuth', [ this.currentProject.code, { request: reqAuthData, logged: true, token }])\r\n                  return res\r\n                })\r\n      }catch(e){\r\n        return new Error(e)\r\n      }\r\n    },\r\n    storageToken({data, headers}){\r\n      let token = null\r\n      if( get(this.config, 'response_mode', 'body') === 'header' ){\r\n        token = headers[ get(this.config, 'response_token', 'access-token') ];\r\n      }else{\r\n        token = get(data, get(this.config, 'response_token', 'access_token'), 'token')\r\n      }\r\n\r\n      if( !token ) {\r\n        return new Error ({message: 'token not found', config: this.config, data, headers})\r\n      }\r\n\r\n      sessionStorage.setItem(`${this.project.code}_session`, token)\r\n      return token\r\n    },\r\n    isLogged(token){\r\n      try{\r\n        \r\n        if( !has(this.config, 'logged_url') ){\r\n          return Promise.reject({message: 'Logged url not found'})\r\n        }\r\n        \r\n        let reqAuthData = this.authRequest(token)\r\n        let options = { method: 'get',  ...reqAuthData  }\r\n\r\n        return request( get(this.config, 'logged_url'), options)\r\n                .then((data) => {\r\n                    let user = this.setUser(data)\r\n                    \r\n                    this.$store.commit('setAuth', [ this.currentProject.code, { user, request: reqAuthData, logged: true, token }])\r\n                    return {token, user, request: reqAuthData }\r\n                })\r\n      }catch(e){\r\n        return Promise.reject({message: e.message})\r\n      }\r\n    },\r\n    authRequest(token){\r\n      let tokenRequest = get(this.config, 'request_token_expression', '{token}')\r\n      if( get(this.config, 'request_mode', 'header') == 'query' )\r\n        return { \r\n          params:{\r\n              [get(this.config, 'request_token', 'access-token')] : interpolate(tokenRequest, {token})\r\n          }\r\n        } \r\n      else \r\n        return {\r\n          headers:{\r\n            [get(this.config, 'request_token', 'access-token')] : interpolate(tokenRequest, {token})\r\n          }\r\n        }\r\n    },\r\n    setUser(data){\r\n      if( !has(this.config, 'logged_model') ) return {};\r\n\r\n      let { id, name, username, role } = get(this.config, 'logged_model')\r\n      let user = {\r\n        \"id\": get(data, id, \"id\"),\r\n        \"name\": get(data, name, \"name\"),\r\n        \"username\": get(data, username, \"email\"),\r\n        \"role\": get(data, role, \"level\")\r\n      }\r\n\r\n      return user;\r\n    }\r\n  },\r\n};\r\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./base.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./base.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CRow',[_c('CCol',{attrs:{\"col\":\"\"}},[_c('CCard',[_c('CCardHeader',[_c('strong',[_vm._v(_vm._s(_vm.currentProject.name)+\" | \"+_vm._s(_vm.active.title))]),_c('div',{staticClass:\"card-header-actions\"},[(_vm.session)?_c('span',[_vm._v(\"Logged as \"+_vm._s(_vm.session.user.name ? _vm.session.user.name: 'anonimous')+\" | \")]):_vm._e(),_c('CButton',{staticClass:\"card-header-action\",attrs:{\"size\":\"sm\"},on:{\"click\":function($event){return _vm.loadModel({ cache:{ ignoreCache: true } })}}},[_c('CIcon',{attrs:{\"name\":\"cil-reload\"}}),_vm._v(\" Model \")],1)],1)]),_c('CCardBody',[(_vm.renderComponent)?_c('section',[_c('Auth',{attrs:{\"project\":_vm.currentProject,\"schema\":_vm.active},on:{\"auth:logged\":_vm.auth,\"auth:failed\":_vm.errors},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar schema = ref.schema;\nreturn [(schema.api)?_c('Table',{ref:\"tables\",attrs:{\"schema\":schema},on:{\"actions:create\":function($event){return _vm.actions('FORM_CREATE', $event)},\"actions:edit\":function($event){return _vm.actions('FORM_EDIT', $event)}}}):_vm._e(),_c('CModal',{attrs:{\"title\":_vm.formTitle,\"show\":_vm.formopen,\"size\":\"lg\",\"closeOnBackdrop\":false},on:{\"update:show\":function($event){_vm.formopen=$event}}},[(_vm.formopen)?_c('Forms',{attrs:{\"formopen\":_vm.formopen,\"schema\":schema,\"data\":_vm.row},on:{\"model:saved\":_vm.formHook,\"close\":_vm.closeForm}}):_vm._e(),_c('template',{slot:\"footer\"},[_c('span')])],2)]}}],null,false,2767369388)})],1):_c('h4',{staticClass:\"text-center\"},[_c('CSpinner',{attrs:{\"color\":\"info\"}})],1)])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <CRow>\r\n    <CCol col>\r\n      <CCard>\r\n        <CCardHeader>\r\n          <strong>{{ currentProject.name }} | {{ active.title }}</strong>\r\n          \r\n          <div class=\"card-header-actions\" >\r\n            <span v-if=\"session\">Logged as {{  session.user.name ? session.user.name: 'anonimous' }} | </span>\r\n            <CButton size=\"sm\" class=\"card-header-action\"  @click=\"loadModel({ cache:{ ignoreCache: true } })\"> \r\n              <CIcon name=\"cil-reload\" /> Model\r\n            </CButton>\r\n          </div>\r\n        </CCardHeader>\r\n        <CCardBody >\r\n          <section v-if=\"renderComponent\">\r\n            <Auth\r\n                :project=\"currentProject\" \r\n                :schema=\"active\"\r\n                @auth:logged=\"auth\"\r\n                @auth:failed=\"errors\"\r\n                \r\n            >\r\n              <template v-slot=\"{ schema }\">\r\n                \r\n                <Table \r\n                  ref=\"tables\" \r\n                  v-if=\"schema.api\"\r\n                  :schema=\"schema\"\r\n                  @actions:create=\"actions('FORM_CREATE', $event)\"\r\n                  @actions:edit=\"actions('FORM_EDIT', $event)\"\r\n                />\r\n\r\n                <CModal\r\n                  :title=\"formTitle\"\r\n                  :show.sync=\"formopen\"\r\n                  size=\"lg\"\r\n                  :closeOnBackdrop=\"false\"\r\n                >\r\n                    <Forms \r\n                      v-if=\"formopen\"\r\n                      :formopen=\"formopen\"\r\n                      :schema=\"schema\" \r\n                      :data=\"row\"\r\n                      @model:saved=\"formHook\"\r\n                      @close=\"closeForm\"\r\n                    /> \r\n                    <template slot=\"footer\"><span></span></template>\r\n                </CModal>\r\n\r\n              </template>\r\n            </Auth>\r\n          </section>\r\n          <h4 v-else class=\"text-center\">\r\n            <CSpinner color=\"info\"/>\r\n          </h4>\r\n        </CCardBody>\r\n    </CCard>\r\n  </CCol>\r\n    \r\n\r\n</CRow>\r\n</template>\r\n\r\n<script>\r\nimport { has, get, set } from 'lodash'\r\nimport ControllerMixin from '../../services/controller.mixin'\r\nimport SessionMixin from '../../services/session.mixin'\r\n\r\nimport Auth from './auth'\r\nimport Table from './table'\r\nimport Forms  from './formulate'\r\n\r\nexport default {\r\n  name: 'Base',\r\n  mixins:[ControllerMixin, SessionMixin],\r\n  components:{\r\n    Auth,\r\n    Table,\r\n    Forms\r\n  },\r\n  data(){\r\n    return{\r\n      models: {},\r\n      row:{},\r\n      formopen:false,\r\n      formLogin:true, \r\n    }\r\n  },\r\n  watch: {\r\n    $route(to, from) {\r\n        if( to.params.model != from.params.model )\r\n          this.loadModel({cache: {ignoreCache: true}})\r\n    },\r\n    currentProject(newVal, oldVal){\r\n      if( has(this.currentProject, 'code') && !oldVal.code ){\r\n        this.loadModel()\r\n      }else if( has(this.currentProject, 'code') && this.currentProject.code !== newVal.code ){\r\n        let res = Object.keys(newVal.resources)\r\n        this.$router.push(`/api/${newVal.code}/${res[0]}`) \r\n      }\r\n    }\r\n  },\r\n  async mounted(){\r\n    if( has(this.currentProject, 'code') )\r\n      this.loadModel()\r\n  },\r\n  computed:{\r\n    formTitle(){ \r\n      return this.row && this.row.id ? `Update ${this.active.title} | ID: ${this.row.id}`: `New ${this.active.title}`\r\n    },\r\n    crud(){\r\n      return this.$store.state.crud || {}\r\n    }\r\n  },\r\n  methods:{\r\n    reloadData() {\r\n      this.$refs.tables.fetchData({ type: \"pageChange\" });\r\n      this.formopen = false;\r\n    },\r\n    closeForm({ refresh }){\r\n        if( refresh )\r\n          this.reloadData()\r\n          \r\n        this.formopen = false;\r\n        this.$store.commit('set', ['crud', {...this.crud, row: null }] )\r\n    },\r\n    actions(action, data){\r\n      if( action == 'FORM_CREATE'){\r\n        this.formopen = true;\r\n        this.row = {}\r\n        this.$store.commit('set', ['crud', {...this.crud, row: {} }] )\r\n      }else if(action == 'FORM_EDIT'){\r\n        this.formopen = true;\r\n        this.row = { ...data }\r\n        this.$store.commit('set', ['crud', {...this.crud, row: this.row }] )\r\n      }else if(action == 'FORM_DELETE'){\r\n          this.deleteData(data).then(() => {\r\n            this.$message('Successfully deleted!')\r\n            this.reloadData()\r\n          })\r\n      }else if(action == 'FORM_DELETEBATCH'){\r\n          let proms = data && data.map(i => this.deleteData(row))\r\n          \r\n          Promise.all(proms)\r\n              .catch( err => this.$message(err.message, 'danger'))\r\n              .then( res => this.$message('All rows delete successfully'))\r\n      }\r\n    },\r\n    auth({ request={}, ...data }) {\r\n      console.log('logged base api', request)\r\n      this.active.api = Object.assign(this.active.api, request); \r\n\r\n      return request\r\n    },\r\n    async formHook(data){\r\n      try{\r\n        return await this.saveData(this.active, data)\r\n          .then((res) => {\r\n              this.closeForm({ refresh: true })\r\n              return res\r\n          })\r\n      }catch(err){\r\n        console.debug('Form submit error', err)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@media (max-width: 728px) {\r\n  .c-body .c-main{\r\n    padding-top: .6em;\r\n    .container-fluid{\r\n      overflow: hidden;\r\n      padding: 0px 0;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./base.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./base.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./base.vue?vue&type=template&id=0a801a1e&\"\nimport script from \"./base.vue?vue&type=script&lang=js&\"\nexport * from \"./base.vue?vue&type=script&lang=js&\"\nimport style0 from \"./base.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}